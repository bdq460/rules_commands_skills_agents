# CodeBuddy 使用指南

> 用 AI 配置 AI，让 CodeBuddy 成为你的专属编程伙伴。

本文档是 CodeBuddy 的完整使用指南，系统介绍所有功能特性、使用方法和最佳实践。

---

## 目录

- [快速开始](#快速开始)
- [功能模块](#功能模块)
  - [记忆](#记忆)
  - [规则](#规则)
  - [Skills](#skills)
  - [Agent](#agent)
  - [自定义命令](#自定义命令)
- [自举机制](#自举机制)
- [如何选择](#如何选择)
- [使用场景](#使用场景)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)

---

## 快速开始

### 第一条命令

打开 CodeBuddy 对话窗口，输入：

```text
参考 CodeBuddy Code 官方文档，你能帮我做哪些事情？
```

这是 CodeBuddy 的**万能公式**，几乎所有配置都从这个句式开始。

### 核心原则

> 你不需要成为 CodeBuddy 的专家，就能让 CodeBuddy 变成你的专家。

**自举的本质**：用 AI 来配置 AI。直接问它关于它自己的一切，让它告诉你如何配置，然后让它帮你完成配置。

### 万能公式

```text
参考 CodeBuddy Code 官方文档，我想要...
```

---

## 功能模块

### 记忆

#### 什么是记忆

记忆功能让 AI Agent 根据和你的对话，自动记住你的偏好、习惯和重要信息，在不同的对话中持续提供个性化的帮助。

就像你的私人助手一样，AI 会记住：

- 你的编码风格和偏好
- 项目的技术栈和架构
- 常用的工具和命令
- 你提到的重要注意事项

#### 记忆的特点

- **自动管理**：通过对话自然创建，AI 识别并存储
- **全局生效**：在所有项目和对话中共享
- **非结构化**：自然语言表达，无需配置文件

#### 记忆层级

| 层级 | 存储位置 | 作用范围 | 适用场景 |
| :--- | :--- | :--- | :--- |
| **用户级** | `~/.codebuddy/CODEBUDDY.md` | 所有项目 | 个人编码风格、语言偏好 |
| **项目级** | `.codebuddy/CODEBUDDY.md` | 当前项目 | 项目规范、技术栈说明 |
| **本地级** | `.codebuddy/local.md` | 当前项目 | 敏感配置（不提交到 Git） |

#### 记忆的使用方法

**创建记忆**：

```text
请记住：我喜欢使用 TypeScript 进行开发，代码风格遵循 Airbnb 规范

记住我喜欢用中文回答问题

请记住：回答时要简洁，避免冗长
```

**更新记忆**：

```text
更改记忆，我喜欢用英文回答
```

**删除记忆**：

```text
删除我喜欢英文回答的记忆
```

**查看记忆**：

```text
参考 CodeBuddy Code 官方文档，查看我当前的配置
```

#### 自举方式

```text
参考 CodeBuddy Code 官方文档，帮我在项目记忆中添加我们的代码规范

参考 CodeBuddy Code 官方文档，创建一个本地记忆文件存储我的测试数据库配置
```

---

### 规则

#### 什么是规则

规则为 AI Agent 提供系统级指令和上下文信息。它们将提示词、工作流程、编码规范等内容打包在一起，便于在团队内管理和共享最佳实践。

#### 规则的特点

- **手动创建**：需要创建 `RULE.mdc` 配置文件
- **结构化**：支持元数据（`alwaysApply`, `description` 等）
- **层级管理**：项目规则（`.codebuddy/rules/`）和用户规则（全局）
- **版本控制**：项目规则可纳入 Git 管理

#### 规则类型

| 类型 | 说明 | 加载方式 | 使用场景 |
| :--- | :--- | :--- | :--- |
| `always` | 总是应用 | 每个会话自动加载全文 | 核心编码规范、架构约束 |
| `requested` | AI 判断相关时应用 | 先加载描述，需要时再读全文 | 文档、参考资料 |
| `manual` | 手动 @ 提及应用 | 不自动加载，需手动触发 | 特定功能指南 |

#### 规则文件格式

```markdown
---
description: TypeScript 编码规范
alwaysApply: true
---

# 编码规范

## 通用偏好

- 使用 4 空格缩进（不使用 Tab）
- 每行最大长度 100 字符
- 函数必须有 JSDoc 注释
```

#### 规则的使用方法

**创建规则**：

```text
参考 CodeBuddy Code 官方文档，生成 TypeScript 编码规范规则

参考 CodeBuddy Code 官方文档，生成 Markdown 文档规范规则
```

**使用规则**：

```text
@typescript-rules 请按规范检查这段代码
```

#### 规则的适用场景

- 项目编码规范（缩进、命名、注释等）
- 架构约束（如：utils 层不能依赖 domain 层）
- 文档格式要求（Markdown 规范、API 文档格式）
- 开发流程（代码审查 checklist、提交规范）
- 质量要求（测试覆盖率、性能标准）

---

### Skills

#### 什么是 Skill

Skills 是为 AI 添加特定领域专业能力的功能扩展包。

#### Skill 的特点

- **即插即用**：可以启用/禁用特定技能
- **专业领域**：如处理 Excel、PDF、图像、特定框架等
- **工具集成**：可集成外部工具和 MCP 服务

#### Skill vs 命令的区别

| 特性 | 命令 | Skill |
| :--- | :--- | :--- |
| 调用方式 | 主动调用（如 `/test`） | 自动识别需求后调用 |
| 使用场景 | 明确知道要做什么 | 描述需求，AI 自动选择 |
| 示例 | `/test` 运行测试 | 说"检查安全问题"自动使用 |

#### Skill 的使用方法

**创建 Skill**：

```text
参考 CodeBuddy Code 官方文档，帮我创建一个代码安全审查的 Skill

参考 CodeBuddy Code 官方文档，创建一个数据库优化的 Skill
```

**使用 Skill**：

Skill 是自动识别的。当你描述相关需求时，AI 会自动调用对应的 Skill。

```text
检查这段代码的安全问题
# 自动使用安全审查 Skill

优化这个数据库查询
# 自动使用数据库优化 Skill
```

#### Skill 的适用场景

- 处理特定文件类型（Excel、PDF、图片等）
- 需要外部工具支持（markdownlint、mcp 工具等）
- 特定框架专业知识（React、Vue、Spring Boot 等）
- 特定领域能力（数据分析、安全审查等）

---

### Agent

#### 什么是 Agent

Agent 是独立执行的 AI 代理实例，用于执行特定任务。

#### Agent 的特点

- **独立会话**：拥有独立的上下文和状态
- **任务导向**：专注于执行特定任务
- **并行处理**：可以同时启动多个 Agent
- **专业分工**：不同 Agent 负责不同领域

#### 内置子代理

| 代理名称 | 用途 |
| :--- | :--- |
| `code-reviewer` | 代码审查 |
| `debugger` | 调试问题 |
| `explainer` | 解释代码 |
| `tester` | 生成测试 |
| `fixer` | 修复问题 |

#### Agent 的使用方法

**创建子代理**：

```text
参考 CodeBuddy Code 官方文档，帮我创建一个专门调试问题的子代理
```

**使用子代理**：

```text
使用 debugger 代理分析这个错误

启动 code-reviewer agent 审查代码质量
```

#### 子代理的优势

- 独立上下文，不污染主对话
- 专业化配置，更好的任务匹配
- 可以限制工具访问权限

#### Agent 的适用场景

- 复杂任务需要分解（代码审查、架构分析）
- 需要并行处理多个独立任务
- 长时间运行的任务（批量处理、大规模重构）
- 需要隔离上下文的任务（避免污染主对话）

---

### 自定义命令

#### 什么是自定义命令

自定义斜杠命令是将常用工作流程封装为可复用的 `/command` 命令。

#### 自定义命令的特点

- **可复用**：一次创建，多次使用
- **可参数化**：支持传入参数
- **层级管理**：项目级命令和用户级命令

#### 命令层级

| 层级 | 存储位置 | 作用范围 |
| :--- | :--- | :--- |
| **项目级** | `.codebuddy/commands/` | 当前项目，团队共享 |
| **用户级** | `~/.codebuddy/commands/` | 所有项目，个人使用 |

#### 自定义命令的使用方法

**创建命令**：

```text
参考 CodeBuddy Code 官方文档，帮我创建一个 /test 命令，运行测试并分析结果

参考 CodeBuddy Code 官方文档，帮我创建 /deploy 命令，一键完成构建和部署
```

**使用命令**：

```text
/test

/review src/auth.ts

/deploy production
```

---

## 自举机制

### 什么是自举

**自举**源自隐喻："用自己的靴带把自己拉起来"。

在 CodeBuddy 的世界里，这意味着：

- 直接问它关于它自己的一切
- 让它告诉你如何配置
- 然后让它帮你完成配置

### 7 步自举法

| 步骤 | 自举方式 | 核心作用 |
| :--- | :--- | :--- |
| **Step 1** | 学会提问 | 了解 CodeBuddy 能做什么 |
| **Step 2** | 记忆配置 | 让它记住你的偏好和习惯 |
| **Step 3** | 创建命令 | 将重复任务封装为斜杠命令 |
| **Step 4** | 创建 Skill | 训练专业领域能力 |
| **Step 5** | 创建子代理 | 分配专属助手处理复杂任务 |
| **Step 6** | 配置 MCP | 连接外部服务能力 |
| **Step 7** | 配置权限 | 控制安全边界 |

**示例**：

```text
Step 1: 参考 CodeBuddy Code 官方文档，你能帮我做哪些事情？
Step 2: 参考 CodeBuddy Code 官方文档，帮我配置用户级记忆
Step 3: 参考 CodeBuddy Code 官方文档，帮我创建一个 /test 命令
Step 4: 参考 CodeBuddy Code 官方文档，帮我创建一个代码安全审查的 Skill
Step 5: 参考 CodeBuddy Code 官方文档，帮我创建一个专门调试问题的子代理
Step 6: 参考 CodeBuddy Code 官方文档，帮我配置 GitHub MCP 服务器
Step 7: 参考 CodeBuddy Code 官方文档，配置权限禁止访问 .env 文件
```

### 自举示例

**完整项目配置**：

```text
参考 CodeBuddy Code 官方文档，帮我为这个新项目初始化完整的 CodeBuddy 配置：
1. 创建项目记忆，记录技术栈是 React + TypeScript
2. 生成编码规范规则
3. 创建常用命令：/test、/build、/deploy
4. 添加代码审查 Skill
```

---

## 如何选择

### 决策树

```text
需求评估
    │
    ├── 是否是个人习惯/偏好？
    │   ├── 是 → 使用记忆（Memory）
    │   └── 否 → 继续
    │
    ├── 是否需要结构化配置和版本控制？
    │   ├── 是 → 使用规则（Rule）
    │   └── 否 → 继续
    │
    ├── 是否需要特定领域的专业能力/工具？
    │   ├── 是 → 使用 Skills
    │   └── 否 → 继续
    │
    └── 是否需要独立执行复杂/长时间任务？
        ├── 是 → 使用 Agent
        └── 否 → 回到规则（通用行为规范）
```

### 快速决策表

| 如果你想说/想做... | 推荐工具 | 理由 |
| :--- | :--- | :--- |
| "请记住我喜欢..." | **记忆** | 个人偏好，无需结构化 |
| "代码必须符合..." | **规则** | 行为规范，需要明确定义 |
| "文档必须包含..." | **规则** | 质量要求，结构化约束 |
| "我需要你能处理 PDF..." | **Skills** | 需要特定能力扩展 |
| "帮我审查整个项目..." | **Agent** | 复杂任务，需要独立执行 |
| "批量处理这些文件..." | **Agent** | 耗时任务，并行处理 |
| "分析项目架构..." | **Agent** | 专业分析，隔离上下文 |

---

## 使用场景

### 场景 1：生成的 Markdown 要格式良好

**分析**：

- 这是质量要求/行为规范
- 需要结构化定义（什么是"良好"？）
- 可能需要团队协作

**推荐**：**规则（Rule）**

```markdown
---
description: Markdown 文档生成规范
alwaysApply: true
---

## 格式要求

1. 所有代码块必须指定语言
2. 未知语言使用 `text`
3. 标题不能重复（MD024）
4. 列表周围需要空行（MD032）
5. 标题后需要空行（MD022）
```

### 场景 2：我喜欢用中文回答问题

**分析**：

- 这是个人偏好
- 不需要结构化配置
- 不需要版本控制

**推荐**：**记忆（Memory）**

```text
请记住：我喜欢用中文回答问题
```

### 场景 3：我需要自动检查 Markdown 格式

**分析**：

- 需要实际执行检查的能力
- 需要工具支持（markdownlint）

**推荐**：**Skills + 规则**

1. 启用 `markdownlint_mcp` skill
2. 配合规则定义何时调用检查

### 场景 4：审查整个项目的代码质量

**分析**：

- 任务复杂且耗时
- 需要独立上下文
- 可能需要并行处理多个模块

**推荐**：**Agent**

```text
启动 code-reviewer agent 进行全面的代码审查
```

---

## 最佳实践

### 组合使用策略

实际工作中，往往需要**组合使用**多个工具：

```text
记忆：我喜欢用中文回答问题（全局偏好）
    ↓
规则：项目编码规范（项目级约束）
    ↓
Skills：启用 markdownlint 进行检查（能力扩展）
    ↓
Agent：批量生成文档（任务执行）
```

**工作流程示例**：

1. **记忆**记录个人偏好（语言、风格等）
2. **规则**定义项目规范（编码、文档格式等）
3. **Skills**提供必要能力（文件处理、工具集成等）
4. **Agent**执行复杂任务（审查、分析、批量处理等）

### 规则管理建议

- 核心规范（3-5 个）设置为 `alwaysApply: true`
- 其他规则设置为 `requested` 或 `manual`
- 规则文件控制在 500 行以内
- 大规则拆分为多个可组合的小规则

### 自举流程建议

```text
第一步：配置记忆（个人偏好）
    ↓
第二步：生成规则（项目规范）
    ↓
第三步：创建命令（常用操作）
    ↓
第四步：添加 Skills（专业领域）
    ↓
第五步：创建 Agent（复杂任务）
```

---

## 常见问题

### Q: 记忆和规则有什么区别？

**记忆**是 AI 记住的事实和偏好（"我喜欢用 TypeScript"），通过对话创建，由 AI 自动管理，全局生效。

**规则**是你设定的行为规范（"代码必须加注释"），需要手动创建配置文件，可精确控制加载时机。

### Q: 规则太多会影响性能吗？

CodeBuddy 会智能加载规则。只有 `alwaysApply: true` 的规则会始终加载，其他规则按需加载。建议：

- 核心规范设置为 always（3-5 个）
- 其他规则设置为 requested 或 manual

### Q: 可以用规则定义自定义命令吗？

规则主要用于指导 AI 行为。如需自定义命令，建议使用 CodeBuddy 的**自定义斜杠命令**功能。

### Q: Skills 和 Rule 的区别是什么？

| 特性 | 规则 | Skills |
| :--- | :--- | :--- |
| 目的 | 规范 AI 行为 | 扩展 AI 能力 |
| 内容 | 指令和约束 | 工具和知识 |
| 形式 | Markdown 配置 | 功能模块 |

### Q: 什么是自举？

自举是让 CodeBuddy 帮你配置 CodeBuddy。通过自然语言描述需求，让 AI 自动生成配置，无需手动编辑配置文件。

---

## 总结

### 使用原则

1. **记忆** = "我的个人喜好"（随性、口头、全局）
2. **规则** = "必须遵守的规范"（正式、结构化、可版本控制）
3. **Skills** = "我需要某项专业能力"（工具、框架、扩展）
4. **Agent** = "执行复杂/耗时任务"（独立、并行、任务级）

### 选择口诀

- 个人偏好 → 记忆
- 规范约束 → 规则
- 能力扩展 → Skills
- 复杂任务 → Agent
- 重复流程 → 自定义命令

### 自举理念

**对话即配置**：

在 CodeBuddy 的世界里，配置不再是编辑晦涩的 JSON 文件或记忆复杂的命令行参数，配置变成了对话：

```text
帮我记住，我喜欢用 4 空格缩进

以后审查代码时，重点关注安全问题

创建一个命令，一键完成测试和部署
```

**成长型 AI**：

| 阶段 | 状态 |
| :--- | :--- |
| 第一天 | 通用的 AI 编程助手 |
| 一周后 | 记住了你的编码风格和项目规范 |
| 一个月后 | 拥有了你创建的专业 Skill 和自动化命令 |
| 持续使用 | 深度了解你、你的团队、你的项目的专属伙伴 |

**万能公式**：

```text
参考 CodeBuddy Code 官方文档，我想要...
```

然后让它帮你完成。

---

## 参考文档

- [CodeBuddy 记忆文档](https://www.codebuddy.cn/docs/ide/User-guide/Memory)
- [CodeBuddy 规则文档](https://www.codebuddy.cn/docs/ide/User-guide/Rules)
- [CodeBuddy 斜杠命令文档](https://www.codebuddy.cn/docs/ide/User-guide/Slash-Commands)
